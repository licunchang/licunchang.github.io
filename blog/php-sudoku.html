<!DOCTYPE html>
<html lang="zh-cmn-Hans-CN">
<head>
<meta charset="utf-8" />
<title>PHP 递归计算所谓“世界最难数独游戏”
 - EOFException</title>
<link rel="stylesheet" href="http://licunchang.com/css/reset.css" />
<link rel="stylesheet" href="http://licunchang.com/css/text.css" />
<link rel="stylesheet" href="http://licunchang.com/css/960_12_col.css" />
<link rel="stylesheet" href="http://licunchang.com/css/demo.css" />
<link rel="stylesheet" href="http://licunchang.com/css/markdown.css" />
</head>
<body>
<div class="container_12">
	<div class="grid_12">
    	<div class="header">
        	<a href="http://licunchang.com/">EOFException</a>
        </div>
    </div>
    <div class="clear"></div>
    <!-- end .header -->
    
    <div class="grid_12">
        <div class="nav">
            <ul>
                <li><a href="http://licunchang.com/">Home</a></li>
                <li><a href="http://licunchang.com/about.html">About</a></li>
            </ul>
            <div class="clear"></div>
        </div>
    </div>
    <div class="clear"></div>
    <!-- end .nav -->

    <div class="grid_12">
        <div class="blog">
            <h1>PHP 递归计算所谓“世界最难数独游戏”
</h1>
            <hr />
            <p>闲，写个程序递归一下新闻中"世界最难数独游戏"。</p>

<pre><code>8    0    0    0    0    0    0    0    0    

0    0    3    6    0    0    0    0    0    

0    7    0    0    9    0    2    0    0    

0    5    0    0    0    7    0    0    0    

0    0    0    0    4    5    7    0    0    

0    0    0    1    0    0    0    3    0    

0    0    1    0    0    0    0    6    8    

0    0    8    5    0    0    0    1    0    

0    9    0    0    0    0    4    0    0    
</code></pre>

<p>上代码</p>

<pre><code>&lt;?php

/**
 * 输出数独
 */
function output($sudoku){
    foreach ($sudoku as $key_row =&gt; $col) {
        foreach ($col as $key_col =&gt; $value_col) {
            echo $value_col . "&amp;nbsp;&amp;nbsp;&amp;nbsp;";
        }
        echo "&lt;br/&gt;&lt;br/&gt;";
    }
}

/**
 * 初始化数独
 */
function init(&amp; $sudoku){

    for($row = 1; $row &lt;= 9; $row++) {
        for($col = 1; $col &lt;= 9; $col++) {
            $sudoku[$row][$col] = 0;
        }
    }

    $sudoku['1']['1'] = 8;
    $sudoku['2']['3'] = 3;
    $sudoku['2']['4'] = 6;
    $sudoku['3']['2'] = 7;
    $sudoku['3']['5'] = 9;
    $sudoku['3']['7'] = 2;
    $sudoku['4']['2'] = 5;
    $sudoku['4']['6'] = 7;
    $sudoku['5']['5'] = 4;
    $sudoku['5']['6'] = 5;
    $sudoku['5']['7'] = 7;
    $sudoku['6']['4'] = 1;
    $sudoku['6']['8'] = 3;
    $sudoku['7']['3'] = 1;
    $sudoku['7']['8'] = 6;
    $sudoku['7']['9'] = 8;
    $sudoku['8']['3'] = 8;
    $sudoku['8']['4'] = 5;
    $sudoku['8']['8'] = 1;
    $sudoku['9']['2'] = 9;
    $sudoku['9']['7'] = 4;
}

/**
 * 根据给出的行列编号给出可用的数字
 */
function advise($sudoku, $row, $col, $row_p, $col_p){

    if($sudoku[$row][$col] != 0){
        return array($sudoku[$row][$col]);
    }
    $temp = array(
            1 =&gt; 0,
            2 =&gt; 0,
            3 =&gt; 0,
            4 =&gt; 0,
            5 =&gt; 0,
            6 =&gt; 0,
            7 =&gt; 0,
            8 =&gt; 0,
            9 =&gt; 0,
        );

    for($i=1; $i &lt;= 9; $i++) { 
        if(array_key_exists($sudoku[$row][$i], $temp) 
            &amp;&amp; isset($temp[($sudoku[$row][$i])])){
            unset($temp[($sudoku[$row][$i])]);
        }
    }
    for($i=1; $i &lt;= 9; $i++) { 
        if(array_key_exists($sudoku[$i][$col], $temp) 
            &amp;&amp; isset($temp[($sudoku[$i][$col])])){
            unset($temp[($sudoku[$i][$col])]);
        }
    }

    $row_stt = (($row_p - 1) * 3 + 1);
    $row_end = ($row_p * 3);

    $col_stt = (($col_p - 1) * 3 + 1);
    $col_end = ($col_p * 3);

    for($i = $row_stt; $i &lt;= $row_end; $i++) { 
        for($j = $col_stt; $j &lt;= $col_end; $j++) { 
            if(array_key_exists($sudoku[$i][$j], $temp) 
                &amp;&amp; isset($temp[($sudoku[$i][$j])])){
                unset($temp[($sudoku[$i][$j])]);
            }
        }
    }
    return array_keys($temp);
}

function sudoku($sudoku, $row = 1, $col = 1){

    $row_p = ceil($row / 3);
    $col_p = ceil($col / 3);

    $available_numbers = advise($sudoku, $row, $col, $row_p, $col_p);

    if(empty($available_numbers)){
        return false;
    }
    else{

        $col_next = $col;
        $row_next = $row + 1;
        if($row_next &gt; 9){
            $row_next = 1;
            $col_next = $col + 1;
        }

        foreach ($available_numbers as $value) {
            $sudoku[$row][$col] = $value;

            if ($row == 9 &amp;&amp; $col == 9) {
                output($sudoku);
                return true;
            }
            if(sudoku($sudoku, $row_next, $col_next)){
                return true;
            }
        }
        return false;
    }
}

function shutdown_func(){
    echo microtime(true)."&lt;br/&gt;";
    echo memory_get_usage();
}

ini_set('max_input_nesting_level', '9999999');
ini_set('max_execution_time', '9999999'); 
ini_set('xdebug.max_nesting_level', '9999999');

$sudoku = array();

echo microtime(true)."&lt;br/&gt;&lt;br/&gt;";

init($sudoku);

sudoku($sudoku);

register_shutdown_function("shutdown_func"); 
</code></pre>

<p>擦，写的好烂啊！</p>

<p>话说最少提供17个数字就能确定一个唯一的数独结果，从这个方面看，估计这个数独远非“世界最难”。</p>

<p>中国记者娱乐无下限！</p>
        </div>
	</div>
    <div class="clear"></div>

    <div class="grid_12">
        <div class="announce">
            <p>原创文章，转载请注明出处。</p>
        </div>
    </div>
    <div class="clear"></div>

    <div class="grid_12">
        <div class="disqus">
            <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = 'licunchang';

                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
                (function () {
                    var s = document.createElement('script'); s.async = true;
                    s.type = 'text/javascript';
                    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
                    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
                }());
            </script>
            <noscript>
            Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
            </noscript>
            <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a> 
        </div>
    </div>
    <!-- end .grid_12 -->
    <div class="clear"></div>

    <div class="grid_12">
        <div class="footer"> &copy; 2013 LiCunchang. All rights reserved.</div>
    </div>
    <!-- end .grid_12 --> 
</div>
<!-- end .container_12 --> 
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fce63e1ea00d8911ba91774df45e565f9' type='text/javascript'%3E%3C/script%3E"));
</script>
</body>
</html>